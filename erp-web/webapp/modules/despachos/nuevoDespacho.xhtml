<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:p="http://primefaces.org/ui"
	template="/templates/pages/pageLayout3.xhtml">
	
	<ui:param name="idForm" value="frmNuevoGuiaDespacho" />
	<ui:param name="form" value="#{despachoController.form}" />	
	<ui:param name="controller" value="#{despachoController}" />
	<ui:param name="westLength" value="250" />
	
	<ui:define name="title">
		Nuevo despacho
	</ui:define>
	
	<ui:define name="header">		
		<ui:include src="nuevoDespachoHeader.xhtml" />
	</ui:define>
	
	<ui:define name="contentCenter">
		<rich:panel header="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.guia.despacho.titulo']}" style="height: 94.5%; width: 100%; background-color: #F5FAFF;">
			<fieldset>
				<legend class="styleLegend">#{msg_erpweb['ec.com.erp.etiqueta.mensaje.datos.generales']}</legend>
				<h:panelGrid id="pnlGridDespacho" columns="6" cellspacing="2" cellpadding="5">
					
					<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.numero.guia']}: *" />
				 	<h:inputText id="numeroGuia" class="styleUpperCase" style="width:150px" value="#{despachoController.guiaDespachoDTO.numeroGuiaDespacho}" 
				 			disabled="true" onkeypress="if (event.keyCode == 13) return false; OnKeyPress(this, event);">
				 	</h:inputText>	
				 	<h:outputText value="" />
				 	<h:outputText style="width: 50px !important;" value="" />
					<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.fecha']}: *" />
					<rich:calendar enableManualInput="true" datePattern="yyyy-MM-dd" value="#{despachoController.guiaDespachoDTO.fechaDespacho}" style="margin-right:10px"/>
					
					<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.placa.vehiculo']}: *" />	
					<h:inputText styleClass="styleUpperCase" style="width:150px" value="#{despachoController.guiaDespachoDTO.placa}" onkeypress="if (event.keyCode == 13) return false; OnKeyPress(this, event);">
				 		<a4j:ajax event="keyup" execute="@this" listener="#{despachoController.realizarConsultaVehiculoPlaca}" onbeforesubmit="if (event.keyCode != 13)  return false;" render="pnlGridDespacho, txtMarca, numDocTransport, nombreTransport, numDocChoferA, nombreChoferA, numDocChoferB, nombreChoferB"/>
				 	</h:inputText>
				 	<h:panelGrid columns="2" cellpadding="3" cellspacing="0" style="padding-left:10px">
						<h:graphicImage name="info.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
						<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.guia.despacho.informacion.busqueda.vehiculo']}" />
					</h:panelGrid>
					<h:outputText style="width: 50px !important;" value="" />
					<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.marca.vehiculo']}: *" />	
					<h:inputText id="txtMarca" maxlength="32" class="styleUpperCase" style="width:162px" value="#{despachoController.guiaDespachoDTO.marca}">
				 	</h:inputText>
				 	
				 	<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.documento.transportista']}: *" />
					<h:inputText class="styleUpperCase" style="width:150px" value="#{despachoController.guiaDespachoDTO.rucTransportista}" id="numDocTransport" maxlength="13" onkeypress="if (event.keyCode == 13) return false; OnKeyPress(this, event);">
				 		<a4j:ajax event="keyup" execute="@this" listener="#{despachoController.realizarConsultaTransportista}" onbeforesubmit="if (event.keyCode != 13)  return false;" render="nombreTransport"/>
				 	</h:inputText>	
				 	<h:panelGrid columns="2" cellpadding="3" cellspacing="0" style="padding-left:10px">
						<h:graphicImage name="info.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
						<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.guia.despacho.informacion.busqueda.trans.chofer']}" />
					</h:panelGrid>
					<h:outputText style="width: 50px !important;" value="" />
				 	<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.nombre.transportista']}: *" />
					<h:inputText class="styleUpperCase" style="width:162px" value="#{despachoController.guiaDespachoDTO.nombreTransportista}" id="nombreTransport" maxlength="64">
				 	</h:inputText>			 		
					
					<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.chofer.principal.documento']}: *" />
					<h:inputText class="styleUpperCase" style="width:150px" value="#{despachoController.guiaDespachoDTO.documentoChoferA}" id="numDocChoferA" maxlength="10">
				 	</h:inputText>	
				 	<h:outputText value="" />
				 	<h:outputText style="width: 50px !important;" value="" />
				 	<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.chofer.principal.nombre']}: *" />
					<h:inputText class="styleUpperCase" style="width:162px" value="#{despachoController.guiaDespachoDTO.nombreChoferA}" id="nombreChoferA" maxlength="64">
				 	</h:inputText>
				 	
				 	<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.chofer.secundario.documento']}: " />
					<h:inputText class="styleUpperCase" style="width:150px" value="#{despachoController.guiaDespachoDTO.documentoChoferB}" id="numDocChoferB" maxlength="10">
				 	</h:inputText>	
				 	<h:outputText value="" />
				 	<h:outputText style="width: 50px !important;" value="" />
				 	<h:outputText class="styleNegritas" value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.chofer.secundario.nombre']}: " />
					<h:inputText class="styleUpperCase" style="width:162px" value="#{despachoController.guiaDespachoDTO.nombreChoferB}" id="nombreChoferB" maxlength="64">
				 	</h:inputText>
					
				</h:panelGrid>
			</fieldset>
			  
			<!-- LISTA DE PEDIDOS ASIGNADOS A LA GUIA -->		
			<h:panelGrid id="divPrincipal" style="width: 100%" columns="2" styleClass="panelPedidos" columnClasses="estiloDivPedidos">
				<h:panelGroup id="flotanteizquierda2" style="width: 100%">
					<rich:toolbar height="26" itemSeparator="grid">
						<rich:toolbarGroup>
							<h:graphicImage name="listachofer.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.pantall.despacho.lista.destinos.pedidos']}"/>
						</rich:toolbarGroup>
						<rich:toolbarGroup location="right">	
							<h:panelGroup layout="block" styleClass="botonD" style="padding-top: 3px; margin-top:0px;">
								<a4j:commandLink oncomplete="#{rich:component('mpPedidos')}.show();" styleClass="agregarD" actionListener="#{despachoController.abrirPopUpPedidos}" render="mpPedidos tablePedidos" execute="@this" title="Click para agregar">
									<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
										<h:graphicImage name="addChofer1.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
										<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.boton.agregar']}"/>
									</h:panelGrid>
								</a4j:commandLink>	
							</h:panelGroup>	
						</rich:toolbarGroup>					
					</rich:toolbar>	
					<rich:panel style="height: 206px;">
						<h:panelGrid id="panelTablaPedidos" columns="1" style="width:100%;">
							<h:panelGrid id="tablaVaciaPedidos" columns="1" rendered="#{empty despachoController.guiaDespachoPedidoDTOCols}" style="width:100%; text-align: center; padding-top: 100px">
								<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.mensaje.lista.vacio']}"/>
							</h:panelGrid>		
											
							<rich:panel style="text-align:center; border-left: none; border-right:none;" rendered="#{not empty despachoController.guiaDespachoPedidoDTOCols}">
								<rich:dataScroller page="#{despachoController.page}" fastStep="3" for="tablePedidosGuia" maxPages="5" rendered="#{not empty despachoController.guiaDespachoPedidoDTOCols}" renderIfSinglePage="false"/>
							</rich:panel>
							<rich:dataTable style="width:100%" value="#{despachoController.guiaDespachoPedidoDTOCols}" rendered="#{not empty despachoController.guiaDespachoPedidoDTOCols}" var="pedido" iterationStatusVar="it" id="tablePedidosGuia" rows="5">
					            <rich:column>
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.guia.orden']}"/></f:facet>
					                <h:outputText value="#{pedido.orden}" />
					            </rich:column>
					            <rich:column>
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.guia.cliente']}"/></f:facet>
					                <rich:panel rendered="#{(pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.razonSocial : pedido.pedidoDTO.clienteDTO.personaDTO.nombreCompleto).length() > 20}" styleClass="tooltip-text" bodyClass="rich-laguna-panel-no-header" style="border: none !important">  
						        		<h:outputText value="#{(pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.razonSocial : pedido.pedidoDTO.clienteDTO.personaDTO.nombreCompleto).length() > 20 ? (pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.razonSocial : pedido.pedidoDTO.clienteDTO.personaDTO.nombreCompleto).substring(0,20).concat('...') : pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.razonSocial : pedido.pedidoDTO.clienteDTO.personaDTO.nombreCompleto}" title="#{pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.razonSocial : pedido.pedidoDTO.clienteDTO.personaDTO.nombreCompleto}"/> 
									</rich:panel>
									<rich:panel rendered="#{(pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.razonSocial : pedido.pedidoDTO.clienteDTO.personaDTO.nombreCompleto).length() le 20}" styleClass="tooltip-text" bodyClass="rich-laguna-panel-no-header" style="border: none !important">  
						        		<h:outputText value="#{pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.razonSocial : pedido.pedidoDTO.clienteDTO.personaDTO.nombreCompleto}"/> 
									</rich:panel>
					            </rich:column>
					            <rich:column>
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.guia.destino']}"/></f:facet>
					                <rich:panel rendered="#{(pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.contactoEmpresaDTO.direccionPrincipal : pedido.pedidoDTO.clienteDTO.personaDTO.contactoPersonaDTO.direccionPrincipal).length() > 25}" styleClass="tooltip-text" bodyClass="rich-laguna-panel-no-header" style="border: none !important">  
						        		<h:outputText value="#{(pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.contactoEmpresaDTO.direccionPrincipal : pedido.pedidoDTO.clienteDTO.personaDTO.contactoPersonaDTO.direccionPrincipal).length() > 25 ? (pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.contactoEmpresaDTO.direccionPrincipal : pedido.pedidoDTO.clienteDTO.personaDTO.contactoPersonaDTO.direccionPrincipal).substring(0,25).concat('...') : pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.contactoEmpresaDTO.direccionPrincipal : pedido.pedidoDTO.clienteDTO.personaDTO.contactoPersonaDTO.direccionPrincipal}" title="#{pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.contactoEmpresaDTO.direccionPrincipal : pedido.pedidoDTO.clienteDTO.personaDTO.contactoPersonaDTO.direccionPrincipal}"/> 
									</rich:panel>
									<rich:panel rendered="#{(pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.contactoEmpresaDTO.direccionPrincipal : pedido.pedidoDTO.clienteDTO.personaDTO.contactoPersonaDTO.direccionPrincipal).length() le 25}" styleClass="tooltip-text" bodyClass="rich-laguna-panel-no-header" style="border: none !important">  
						        		<h:outputText value="#{pedido.pedidoDTO.clienteDTO.personaDTO == null ? pedido.pedidoDTO.clienteDTO.empresaDTO.contactoEmpresaDTO.direccionPrincipal : pedido.pedidoDTO.clienteDTO.personaDTO.contactoPersonaDTO.direccionPrincipal}"/> 
									</rich:panel>
					            </rich:column>
					            <rich:column style="width: 80px; text-align: right; padding-right: 3px;">
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.guia.total.pedido']}"/></f:facet>
					                <h:outputText value="#{pedido.pedidoDTO.totalCompra}">
					                	<f:convertNumber pattern="0.00"/>
	                				</h:outputText>
					            </rich:column>
					            <rich:column>
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.guia.observacion']}"/></f:facet>
					                <h:inputText value="#{pedido.observacion}" maxlength="64"/>
					            </rich:column>					         
					            <rich:column styleClass="columna5">
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.boton.eliminar']}"/></f:facet>
					                <a4j:commandLink id="botonEliminar" execute="@this" actionListener="#{despachoController.cargarDatosEliminar}" oncomplete="validarEstadoPedido();">
										<h:graphicImage library="images" name="deleteReg.png" title="Borrar" width="16" height="16"/>
										<f:setPropertyActionListener value="#{pedido}" target="#{despachoController.guiaDespachoPedidoDTO}" />											
									</a4j:commandLink>	
					            </rich:column>            
					        </rich:dataTable>						
						</h:panelGrid>
					</rich:panel>
				</h:panelGroup>
				<h:panelGroup style="width: 100%">
					<rich:toolbar height="26" itemSeparator="grid">
						<rich:toolbarGroup>
							<h:graphicImage name="listachofer.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.guia.despacho.titulo.articulos.extras']}"/>
						</rich:toolbarGroup>
						<rich:toolbarGroup location="right">	
							<h:panelGroup layout="block" styleClass="botonD" style="padding-top: 3px; margin-top:0px;">
								<a4j:commandLink styleClass="agregarD" actionListener="#{despachoController.agragarRegistroExtra}" render="panelTablaAdicional tablePedidosExtra" execute="@this" title="Click para agregar fila">
									<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
										<h:graphicImage name="addChofer1.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
										<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.boton.agregar']}"/>
									</h:panelGrid>
								</a4j:commandLink>	
							</h:panelGroup>	
						</rich:toolbarGroup>						
					</rich:toolbar>	
					<rich:panel style="height: 206px;">
						<h:panelGrid id="panelTablaAdicional" columns="1" style="width:100%;">
							<h:panelGrid id="tablaVaciaAdicional" columns="1" rendered="#{empty despachoController.guiaDespachoExtrasDTOCols}" style="width:100%; text-align: center; padding-top: 100px">
								<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.mensaje.lista.vacio']}"/>
							</h:panelGrid>	
							<rich:panel style="text-align:center; border-left: none; border-right:none;" rendered="#{not empty despachoController.guiaDespachoExtrasDTOCols}">
								<rich:dataScroller page="#{despachoController.page}" fastStep="3" for="tablePedidosExtra" maxPages="5" rendered="#{not empty despachoController.guiaDespachoExtrasDTOCols}" renderIfSinglePage="false"/>
							</rich:panel>					
							<rich:dataTable style="width:100%; height:20%" value="#{despachoController.guiaDespachoExtrasDTOCols}" rendered="#{not empty despachoController.guiaDespachoExtrasDTOCols}" var="pedido" iterationStatusVar="itera" id="tablePedidosExtra" rows="5">
								<rich:column style="width:3% !important;">
					                <f:facet name="header">Nro.</f:facet>
					                #{itera.index+1}
					            </rich:column>
					            <rich:column styleClass="autoStyle" style="width:75% !important">
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.guia.descripcion.producto']}"/></f:facet>
					                <p:autoComplete id="themeCustom" value="#{pedido.descripcionProducto}" completeMethod="#{despachoController.completeNombreArticuloExtra}">
	            						<p:ajax event="itemSelect"  listener="#{despachoController.onItemSelectExtra}" update=":frmNuevoGuiaDespacho:panelTablaAdicional"/>
	        						</p:autoComplete>
					            </rich:column>
					            <rich:column style="width:10% !important; text-align:right !important;">
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.lista.cabecera.guia.cantidad']}"/></f:facet>
					                <h:inputText onkeypress="return validarEnteros(event);" maxlength="10" value="#{pedido.cantidad}" style="width:70px !important; height: 14px !important;"/>
					            </rich:column>			           					         
					            <rich:column style="width:10% !important; text-align:center !important;">
					                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.boton.eliminar']}"/></f:facet>
					                <a4j:commandLink id="botonEliminar" execute="@this" actionListener="#{despachoController.cargarDatosEliminar}" oncomplete="validarExtras();">
										<h:graphicImage library="images" name="deleteReg.png" title="Borrar" height="16" width="16"/>
										<f:setPropertyActionListener value="#{pedido}" target="#{despachoController.guiaDespachoExtrasDTO}" />											
									</a4j:commandLink>	
					            </rich:column>            
					        </rich:dataTable>						
							
						</h:panelGrid>
					</rich:panel>
				</h:panelGroup>
			</h:panelGrid>
		</rich:panel>
		<a4j:jsFunction name="validarEstadoPedido" render="panelTablaPedidos pnlMensajes" actionListener="#{despachoController.validarEstadoPedido}" oncomplete="if(#{despachoController.sePuedeEliminar})#{rich:component('mpEliminarPedido')}.show(); return false;"></a4j:jsFunction>
		<a4j:jsFunction name="validarExtras" render="panelTablaAdicional pnlMensajes" actionListener="#{despachoController.validarExtras}" oncomplete="if(#{despachoController.sePuedeEliminar})#{rich:component('mpEliminarExtras')}.show(); return false;"></a4j:jsFunction>
		<!-- Popup para agregar nuevo chofer -->
		<rich:popupPanel id="mpPedidos" header="#{msg_erpweb['ec.com.erp.etiqueta.label.nuevo.pedidos.titulo.lista.pedido']}" width="1000" height="450" modal="true" domElementAttachment="form">
			<f:facet name="controls">
				<h:outputLink value="#"	onclick="#{rich:component('mpPedidos')}.hide();">
					<h:graphicImage library="images" name="close.png" style="border:0px" id="closePopUpChofer" />
				</h:outputLink>
			</f:facet>
			
			<rich:panel header="Pedidos pendientes de entrega" style="height: 370px">
				<h:panelGrid id="tablaVacia" columns="1" rendered="#{empty despachoController.pedidosDTOCols}" style="width:100%; text-align: center; padding-top: 160px">
					<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.mensaje.lista.vacio']}"/>
				</h:panelGrid>
				<rich:panel style="text-align:center; border-left: none; border-right:none; border-bottom:none" rendered="#{not empty despachoController.pedidosDTOCols}">
					<rich:dataScroller for="tablePedidos" maxPages="5" rendered="#{not empty despachoController.pedidosDTOCols}" renderIfSinglePage="false"/>
				</rich:panel>
				<rich:dataTable style="width:100%" value="#{despachoController.pedidosDTOCols}" rendered="#{not empty despachoController.pedidosDTOCols}" var="pedido" iterationStatusVar="it" id="tablePedidos" rows="8">
					<rich:column style="padding:0px;padding-left:2px" >
						<h:selectBooleanCheckbox id="myCheck" value="#{pedido.seleccionado}">
				        </h:selectBooleanCheckbox>
					</rich:column>
		            <rich:column>
		                <f:facet name="header">Nro.</f:facet>
		                #{it.index+1}
		            </rich:column>
		            <rich:column>
		                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.header.tabla.tipo.cliente']}"/></f:facet>
		                <h:outputText value="#{pedido.clienteDTO.tipoClienteCatalogoValorDTO.nombreCatalogoValor}" />
		            </rich:column>
		            <rich:column>
		                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.header.tabla.nombre.cliente']}"/></f:facet>
		                <h:outputText value="#{pedido.clienteDTO.personaDTO.nombreCompleto == null ? pedido.clienteDTO.empresaDTO.razonSocial : pedido.clienteDTO.personaDTO.nombreCompleto}" />
		            </rich:column>
		            <rich:column>
		                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.header.tabla.direccion.cliente']}"/></f:facet>
		                <h:outputText value="#{pedido.clienteDTO.personaDTO == null ? pedido.clienteDTO.empresaDTO.contactoEmpresaDTO.direccionPrincipal : pedido.clienteDTO.personaDTO.contactoPersonaDTO.direccionPrincipal}" />
		            </rich:column>
		            <rich:column>
		                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.nuevo.pedidos.etiqueta.fechapedido']}"/></f:facet>
		                <h:outputText value="#{pedido.fechaPedido}">
		                	<f:convertDateTime pattern="yyyy-MM-dd"/>
		                </h:outputText>
		            </rich:column>
		            <rich:column style="width: 60px; text-align: right; padding-right: 3px;">
		                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.nuevo.pedidos.detalle.total']}"/></f:facet>
		                <h:outputText value="#{pedido.totalCompra}">
		                	<f:convertNumber pattern="0.00"/>
		                </h:outputText>
		            </rich:column>
		            <rich:column>
		                <f:facet name="header"><h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.label.nuevo.pedidos.etiqueta.estadoPedido']}"/></f:facet>
		                <h:outputText value="#{pedido.estadoPedidoDTO.estadoCatalogoValorDTO.nombreCatalogoValor}" />
		            </rich:column>
		        </rich:dataTable>
		    </rich:panel>
			
			<!-- Botones de PopUp -->
			<h:panelGrid style="margin:auto;" columns="2" cellpadding="0" cellspacing="0">
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px;margin-right:20px;">
					<a4j:commandLink id="btnAceptarAgregarPedido" execute="tablePedidos" render="panelTablaPedidos" styleClass="aceptarD" actionListener="#{despachoController.agragarPedido}" oncomplete="if(#{despachoController.controlPopUp})#{rich:component('mpPedidos')}.hide(); return false;">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="btnAceptar.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Aceptar" />
						</h:panelGrid>
					</a4j:commandLink>					
				</h:panelGroup>
	
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px;">
					<a4j:commandLink id="btnCancelarAgregarPedido" styleClass="cancelarD" oncomplete="#{rich:component('mpPedidos')}.hide(); return false;" immediate="true">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="btnCancel.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Cancelar" />
						</h:panelGrid>
					</a4j:commandLink>
				</h:panelGroup>
			</h:panelGrid>
		</rich:popupPanel>
		
		
		<!-- Popup para confirmar que se guardo la guia de despacho -->
		<rich:popupPanel id="mpConfirmacion" header="#{msg_erpweb['ec.com.erp.etiqueta.mensaje.informacion']}" width="345" height="160" modal="true" domElementAttachment="form">
			<f:facet name="controls">
				<h:outputLink value="#"	onclick="#{rich:component('mpConfirmacion')}.hide();">
					<h:graphicImage library="images" name="close.png" style="border:0px"/>
				</h:outputLink>
			</f:facet>
			
			<rich:panel style="height: 94%">
				<h:panelGrid columns="3">
					<h:graphicImage name="info.png" library="images" style="border:none;border-color:white;" height="48" width="48"/>
					<h:panelGroup style="margin-right:20px;">
					</h:panelGroup>
					<h:panelGroup style="text-align:justify;">
						<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.pantalla.guia.despacho.mensaje.informacion']}" />
					</h:panelGroup>
				</h:panelGrid>
		    </rich:panel>
			
			<!-- Botones de PopUp -->
			<h:panelGrid style="margin:auto; padding-top: 5px;" columns="3" cellpadding="0" cellspacing="0">
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px;margin-right:20px;">
					<a4j:commandLink styleClass="aceptarD" render="pnlMensajes" oncomplete="imprimirGuiaDespacho();#{rich:component('mpConfirmacion')}.hide(); return false;" execute="@this" actionListener="#{despachoController.cargarGuiaImprimir}">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="btnImprimir.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Imprimir" />
						</h:panelGrid>
					</a4j:commandLink>
				</h:panelGroup>
	
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px; margin-right:20px;">
					<a4j:commandLink styleClass="cancelarD" execute="@this" render="pnlGridDespacho, panelTablaPedidos, panelTablaAdicional, pnlMensajes" actionListener="#{despachoController.clearNuevoDespacho}" oncomplete="#{rich:component('mpConfirmacion')}.hide(); return false;">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="btnNuevoA.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Nueva" />
						</h:panelGrid>
					</a4j:commandLink>
				</h:panelGroup>
				
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px;">
					<a4j:commandLink styleClass="cancelarD" action="#{despachoController.regresarBusquedaDespachos}" oncomplete="#{rich:component('mpConfirmacion')}.hide(); return false;" immediate="true">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="btnCancel.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Cancelar" />
						</h:panelGrid>
					</a4j:commandLink>
				</h:panelGroup>
			</h:panelGrid>
		</rich:popupPanel>
		
		<!-- Popup para eliminar pedido asignado a la guia-->
		<rich:popupPanel id="mpEliminarPedido" header="#{msg_erpweb['ec.com.erp.etiqueta.mensaje.confirmacion']}" width="345" height="160" modal="true" domElementAttachment="form">
			<f:facet name="controls">
				<h:outputLink value="#"	onclick="#{rich:component('mpEliminarPedido')}.hide();">
					<h:graphicImage library="images" name="close.png" style="border:0px"/>
				</h:outputLink>
			</f:facet>
			
			<rich:panel style="height: 94%">
				<h:panelGrid columns="3">
					<h:graphicImage name="close_session.png" library="images" style="border:none;border-color:white;" height="48" width="48"/>
					<h:panelGroup style="margin-right:20px;">
					</h:panelGroup>
					<h:panelGroup style="text-align:justify;">
						<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.mensaje.popUp.eliminacion']}" />
					</h:panelGroup>
				</h:panelGrid>
		    </rich:panel>
			
			<!-- Botones de PopUp -->
			<h:panelGrid style="margin:auto; padding-top: 5px;" columns="3" cellpadding="0" cellspacing="0">
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px; margin-right:20px;">
					<a4j:commandLink styleClass="cancelarD" execute="@this" render="panelTablaPedidos pnlMensajes" actionListener="#{despachoController.borrarPedido}" oncomplete="#{rich:component('mpEliminarPedido')}.hide(); return false;">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="deleteReg.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Eliminar" />
						</h:panelGrid>
					</a4j:commandLink>
				</h:panelGroup>
				
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px;">
					<a4j:commandLink actionListener="#{despachoController.cancelarBorrarPedido}" styleClass="cancelarD" oncomplete="#{rich:component('mpEliminarPedido')}.hide(); return false;" immediate="true">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="btnCancel.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Cancelar" />
						</h:panelGrid>
					</a4j:commandLink>
				</h:panelGroup>
			</h:panelGrid>
		</rich:popupPanel>
		
		<!-- Popup para eliminar articulos extras-->
		<rich:popupPanel id="mpEliminarExtras" header="#{msg_erpweb['ec.com.erp.etiqueta.mensaje.confirmacion']}" width="345" height="160" modal="true" domElementAttachment="form">
			<f:facet name="controls">
				<h:outputLink value="#"	onclick="#{rich:component('mpEliminarExtras')}.hide();">
					<h:graphicImage library="images" name="close.png" style="border:0px"/>
				</h:outputLink>
			</f:facet>
			
			<rich:panel style="height: 94%">
				<h:panelGrid columns="3">
					<h:graphicImage name="close_session.png" library="images" style="border:none;border-color:white;" height="48" width="48"/>
					<h:panelGroup style="margin-right:20px;">
					</h:panelGroup>
					<h:panelGroup style="text-align:justify;">
						<h:outputText value="#{msg_erpweb['ec.com.erp.etiqueta.mensaje.popUp.eliminacion']}" />
					</h:panelGroup>
				</h:panelGrid>
		    </rich:panel>
			
			<!-- Botones de PopUp -->
			<h:panelGrid style="margin:auto; padding-top: 5px;" columns="3" cellpadding="0" cellspacing="0">
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px; margin-right:20px;">
					<a4j:commandLink styleClass="cancelarD" execute="@this" render="panelTablaAdicional pnlMensajes" actionListener="#{despachoController.borrarPedidoExtra}" oncomplete="#{rich:component('mpEliminarExtras')}.hide(); return false;">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="deleteReg.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Eliminar" />
						</h:panelGrid>
					</a4j:commandLink>
				</h:panelGroup>
				
				<h:panelGroup layout="block" styleClass="botonD" style="margin-top:5px;">
					<a4j:commandLink actionListener="#{despachoController.cancelarBorrarPedidoExtra}" styleClass="cancelarD" oncomplete="#{rich:component('mpEliminarExtras')}.hide(); return false;" immediate="true">
						<h:panelGrid columns="2" cellpadding="3" cellspacing="0">
							<h:graphicImage name="btnCancel.png" library="images" style="border:none;border-color:white;" height="16" width="16"/>
							<h:outputText value="Cancelar" />
						</h:panelGrid>
					</a4j:commandLink>
				</h:panelGroup>
			</h:panelGrid>
		</rich:popupPanel>
		<script type="text/javascript">
			/*<![CDATA[*/	
				function radioButton(radio) {
					var id = radio.name.substring(radio.name.lastIndexOf(':'));
					var el = radio.form.elements;
					for (var i = 0; i < el.length; i++) {
						if (el[i].name.substring(el[i].name.lastIndexOf(':')) == id) {
						el[i].checked = false;
						}
					}
					radio.checked = true;
				}
					
				function validarEnteros(e) {
					tecla = (document.all) ? e.keyCode : e.which; 
					if (tecla==8) return true; 
					patron =/[0-9\s]/; 
					te = String.fromCharCode(tecla);
					return patron.test(te);
				}
				
				function imprimirGuiaDespacho(){
					$('.linkprintguide').trigger('click');
				}
			/*]]>*/
		</script>
		
		<h:outputStylesheet>
			.estiloDivPedidos{
				width: 60% !important;
			}	
			
			.tooltip-text {     
			  	cursor: arrow;    
			  	border-width: 2px;     
			  	text-align: center;       
			  	display: table-cell;       
			  	vertical-align: middle;   
				background-color: #FFFFFF !important;  	  
		  	}	
		  	
		  	.autoStyle .ui-inputfield{
			    -webkit-box-shadow: inset 0 0px 0px #8f8f8f !important;
			    height: 7px !important;
			    width: 300px !important;
			}	
		</h:outputStylesheet>
		<h:commandLink id="linkprintguide" styleClass="linkprintguide" action="#{despachoController.imprimirNotaDespacho}" target="_BLANK">
		</h:commandLink>	
	</ui:define>
	
</ui:composition>